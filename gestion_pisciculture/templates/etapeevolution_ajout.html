{% extends 'base.html' %} 

{% block content %}

{% load humanize %}
{% load custom_filters %}


                <!-- Begin Page Content -->
                <div class="container-fluid">

                        <div class="card shadow mb-4">
                            <div class="card-header py-3">
                                <h1 class="m-0 font-weight-bold text-primary">Ajout d'une nouvelle étape d'évolution</h1>
                            </div>
                            <div class="card-body">

                            <form  class="user" method="post" action="{% url 'ajouter_EtapeEvolution' %}">                           
                                {% csrf_token %}
                                 <div class="form-group">
                                {{ form.as_p }}
                                </div>
                                <button class="btn btn-success btn-lg btn-icon-split" style="padding: 15px 30px; width: 100%;" type="submit" >Valider</button>

                            </form>

                            </div>
                        </div>

                </div>
                <!-- /.container-fluid -->

 <script>
         // Fonction pour calculer automatiquement le nombre de jours entre la date de début et la date de fin
         function calculerNombreJours() {
             let dateDebut = new Date(document.getElementById('id_date_debut').value);
             let dateFin = new Date(document.getElementById('id_date_fin').value);
         
             if (!isNaN(dateDebut.getTime()) && !isNaN(dateFin.getTime())) {
                 let differenceTemps = dateFin - dateDebut;
                 let nombreJours = differenceTemps / (1000 * 3600 * 24);  // Conversion en jours
         
                 if (nombreJours >= 0) {
                     document.getElementById('id_nombre_jour').value = nombreJours;
                 } else {
                     document.getElementById('id_nombre_jour').value = '';
                 }
             }
         }
         
         // Fonction pour calculer automatiquement la date de fin en fonction de la date de début et du nombre de jours
         function calculerDateFin() {
             let dateDebut = new Date(document.getElementById('id_date_debut').value);
             let nombreJours = parseInt(document.getElementById('id_nombre_jour').value);
         
             if (!isNaN(dateDebut.getTime()) && !isNaN(nombreJours) && nombreJours > 0) {
                 let dateFin = new Date(dateDebut);
                 dateFin.setDate(dateDebut.getDate() + nombreJours);
         
                 // Mettre à jour le champ de date de fin avec la nouvelle date
                 document.getElementById('id_date_fin').value = dateFin.toISOString().split('T')[0];  // Formater en YYYY-MM-DD
             }
         }
         
         // Attacher les événements pour recalculer les valeurs quand les champs changent
         document.getElementById('id_date_debut').addEventListener('change', calculerNombreJours);
         document.getElementById('id_date_fin').addEventListener('change', calculerNombreJours);
         document.getElementById('id_nombre_jour').addEventListener('input', calculerDateFin);
         </script>

{% endblock content %} 